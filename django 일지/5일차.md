# 5일차

## 1. new review

### 1.1. svelte

사용량은 적지만 개발자들이 좋아하는 프론트엔드 프레임워크

### 1.2. react

리엑트가 사용량이 가장 많다.

장고와 리엑트를 같이 쓰면 페이지를 그리는 책임에 대한 문제가 있다.

## 2. 컴퓨터가 1초에 할 수 있는 일

### 2.1. 생각보다 할 수 있는 게 많다.

[링크](https://computers-are-fast.github.io/)

## 3. new project

새 프로젝트 생성

위치는 기존과 다르게

### 3.1. init

```bash
pip install django
django-admin startproject mysite .
```

현제 폴더에 프로젝트 시작

```bash
git init
touch .gitignore
```

[gitignore.io](gitignore.io) 가서 django ignore 생성하여 .gitignore에 붙여넣기

(.idea, .vscode도 추가해주기)

**commit**

```bash
git add .gitignore
git commit -m "add .gitignore"
```

gitignore 먼저 추가

```bash
git add .
git commit -m "add files"
```

### 3.2. settings 변경

mysite/settings.py

```python
import os
...
ALLOWED_HOSTS = ["localhost", "127.0.0.1"]
...
TEMPLATES = [
    {
        ...
        "DIRS": [os.path.join(BASE_DIR, "templates")],
        ...
    },
]
...
LANGUAGE_CODE = "ko-kr"

TIME_ZONE = "Asia/Seoul"
...
MEDIA_URL = "/media/"
MEDIA_ROOT = os.path.join(BASE_DIR, "media")
```

### 3.3. 폴더 생성

```bash
mkdir templates
mkdir media
mkdir static
```

**결과**

```bash
$ ls
manage.py*  media/  mysite/  static/  templates/  venv/
```

**commit**

```bash
git add settings.py
git commit -m "설정 변경"
```

### 3.4. app 생성

```bash
python manage.py startapp bookmark
```

mysite/settings.py

```python
INSTALLED_APPS = [
    "bookmark.apps.BookmarkConfig",
    ...
]
```

**commit**

```bash
git commit -a -m "add bookmark app"
```

### 3.5. migrate

```bash
python manage.py migrate
```

### 3.6. admin 계정 생성

```bash
python manage.py createsuperuser
사용자 이름 (leave blank to use 'terry'): admin
이메일 주소: munu220@gmail.com
Password: #1234
Password (again): #1234
비밀번호가 너무 짧습니다. 최소 8 문자를 포함해야 합니다.
비밀번호가 너무 일상적인 단어입니다.
비밀번호가 전부 숫자로 되어 있습니다.
Bypass password validation and create user anyway? [y/N]: y
Superuser created successfully.
```

## 4. bookmark 모델 생성

### 4.1. Bookmark 모델 생성

bookmark/models.py

```python
from django.db import models

class Bookmark(models.Model):
    title = models.CharField("TITLE", max_length=100, blank=True)
    url = models.URLField("URL", unique=True)

    def __str__(self):
        return self.title
```

**commit**

```bash
commit -a -m "add Bookmark model"
```

### 4.2. bookmark admin 등록

bookmark/admin.py

```python
from django.contrib import admin
from bookmark.models import Bookmark

# 데코레이터 패턴을 사용하지 않는 방법
# admin.site.register(Bookmark)

@admin.register(Bookmark)
class BookAdmin(admin.ModelAdmin):
    list_display = ("id", "title", "url")
```

**commit**

```bash
git commit -a -m "add Bookmark admin"
```

### 4.3 migrate

```bash
python manage.py makemigrations
python manage.py migrate
```

**commit**

```bash
git commit -a -m "migrate"
```

runserver로 확인

### url 수정

mysite/urls.py

```python
from django.contrib import admin
from django.urls import path
from bookmark.views import BookmarkLV, BookmarkDV

urlpatterns = [
    path("admin/", admin.site.urls),
    path("bookmark/", BookmarkLV.as_view(), name="index"),
    path("bookmark/<int:pk>/", BookmarkDV.as_view(), name="detail"),
]
```

class 형 view?

### views 생성

**bookmark/views.py**

```python
from django.views.generic import ListView, DetailView
from django.shortcuts import render
from bookmark.models import Bookmark

# Create your views here.
class BookmarkLV(ListView):
    model = Bookmark

class BookmarkDV(DetailView):
    model = Bookmark
```

## templates 생성

### 5.1. 파일 생성

**bookmark/templates\bookmark\bookmark_list.html**

```html
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Django Bookmark List</title>
  </head>
  <body>
    <div id="content">
      <h1>Bookmark List</h1>
      <ul>
        {% for bookmark in object_list %}
          <li>
            <a href="{% url 'detail' bookmark.id %}">{{ bookmark }}</a>
          </li>
        {% endfor %}
      </ul>
    </div>
  </body>
</html>
```

**bookmark\templates\bookmark\bookmark_detail.html**

```html
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Django Bookmark Detail</title>
  </head>
  <body>
    <div id="content">
      <h1>{{ object.title }}</h1>
      <ul>
        <li>
          URL: <a href="{{ object.url }}">{{ object.url }}</a>
        </li>
      </ul>
    </div>
  </body>
</html>
```

### 5.2. templates 자동 경로

**mysite/settings.py**

```python
TEMPLATES = [
    {
        ...
        "DIRS": [],
        ...
    },
]
```

`settings.py`에서 `DIRS`를 비워놓으면 자동으로 `templates` 폴더를 찾아서 사용한다.

**commit**

```bash
git commit -a -m "add templates"
```

## 6. blog 앱 생성

### 6.1. blog 앱 생성

```bash
python manage.py startapp blog
```

### 6.2. blog app 등록

**mysite/settings.py**

```python
INSTALLED_APPS = [
    "bookmark.apps.BookmarkConfig",
    "blog.apps.BlogConfig",
    ...
]
```

**Commit**

```bash
git commit -a -m "add blog app"
```

### 6.3. blog 모델 생성

**blog/models.py**

```python
from django.db import models

class Post(models.Model):
    title = models.CharField(verbose_name="TITLE", max_length=50)
    slug = models.SlugField(
        "SLUG", unique=True, allow_unicode=True, help_text="one word for title alias."
    )
    description = models.CharField(
        "DESCRIPTION", max_length=100, blank=True, help_text="simple description text."
    )
    content = models.TextField("CONTENT")
    created_dt = models.DateTimeField("CREATE DATE", auto_now_add=True)
    modify_dt = models.DateTimeField("MODIFY DATE", auto_now=True)

    class Meta:
        verbose_name = "post"
        verbose_name_plural = "posts"
        db_table = "blog_posts"
        ordering = ("-modify_dt",)

    def __str__(self):
        return self.title
```

**Commit**

```bash
git commit -a -m "add Post model at blog"
```

### 6.4. slug란?

간단하게 페이지나 포스트를 설명하는 몇개 단어의 집합이다. title은 중복될 수 있지만 slug는 중복될 수 없다. slug는 url에 페이지 id 대신에 사용되는 것으로 추정된다.

### 6.5. blog admin 등록

**blog/admin.py**

```python
from django.contrib import admin
from blog.models import Post


@admin.register(Post)
class PostAdmin(admin.ModelAdmin):
    list_display = ("id", "title", "modify_dt")
    list_filter = ("modify_dt",)
    search_fields = ("title", "content")
    prepopulated_fields = {"slug": ("title",)}
```

**Commit**

```bash
git commit -a -m "add Post admin"
```

### 6.6. blog migrate

```bash
python manage.py makemigrations
python manage.py migrate
```

**commit**
  
```bash
git commit -a -m "migrate"
```